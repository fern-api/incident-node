// This file was auto-generated by Fern from our API Definition.

import { IncidentIOClient } from "../../src/Client";
import { mockServerPool } from "../mock-server/MockServerPool";

describe("IncidentMembershipsV1Client", () => {
    test("create", async () => {
        const server = mockServerPool.createServer();
        const client = new IncidentIOClient({ maxRetries: 0, environment: server.baseUrl });
        const rawRequestBody = { incident_id: "01ET65M7ZADYFCKD4K1AE2QNMC", user_id: "01FCQSP07Z74QMMYPDDGQB9FTG" };
        const rawResponseBody = {
            incident_membership: {
                created_at: "2021-08-17T13:28:57Z",
                id: "01FCNDV6P870EA6S7TK1DSYD5H",
                incident_id: "01FCNDV6P870EA6S7TK1DSYD5H",
                updated_at: "2021-08-17T13:28:57Z",
                user: {
                    email: "lisa@incident.io",
                    id: "01FCNDV6P870EA6S7TK1DSYDG0",
                    name: "Lisa Karlin Curtis",
                    role: "viewer",
                    slack_user_id: "U02AYNF2XJM",
                },
            },
        };
        server
            .mockEndpoint()
            .post("/v1/incident_memberships")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.incidentMembershipsV1.create({
            incident_id: "01ET65M7ZADYFCKD4K1AE2QNMC",
            user_id: "01FCQSP07Z74QMMYPDDGQB9FTG",
        });
        expect(response).toEqual({
            incident_membership: {
                created_at: "2021-08-17T13:28:57Z",
                id: "01FCNDV6P870EA6S7TK1DSYD5H",
                incident_id: "01FCNDV6P870EA6S7TK1DSYD5H",
                updated_at: "2021-08-17T13:28:57Z",
                user: {
                    email: "lisa@incident.io",
                    id: "01FCNDV6P870EA6S7TK1DSYDG0",
                    name: "Lisa Karlin Curtis",
                    role: "viewer",
                    slack_user_id: "U02AYNF2XJM",
                },
            },
        });
    });

    test("revoke", async () => {
        const server = mockServerPool.createServer();
        const client = new IncidentIOClient({ maxRetries: 0, environment: server.baseUrl });
        const rawRequestBody = { incident_id: "01FCNDV6P870EA6S7TK1DSYD5H", user_id: "01FCQSP07Z74QMMYPDDGQB9FTG" };

        server
            .mockEndpoint()
            .post("/v1/incident_memberships/actions/revoke")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .build();

        const response = await client.incidentMembershipsV1.revoke({
            incident_id: "01FCNDV6P870EA6S7TK1DSYD5H",
            user_id: "01FCQSP07Z74QMMYPDDGQB9FTG",
        });
        expect(response).toEqual(undefined);
    });
});
